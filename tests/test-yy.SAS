DATA ncarbe;
  INFILE 'C:\Users\mdlhs\asancpt\ncarbe\beNCAdataset.csv' FIRSTOBS=2 DLM="," ;
  INPUT SUBJ $ TRT $ SEQ $ PRD $ AUClast Cmax Tmax ;
  LNCMAX = LOG(Cmax); 
  LNAUCL = LOG(AUClast );

PROC PRINT; RUN;

PROC GLM DATA=ncarbe;
  CLASS SEQ SUBJ PRD TRT ;
  MODEL LNAUCL = SEQ SUBJ(SEQ) PRD TRT; 
  RANDOM SUBJ(SEQ)/TEST ; 
RUN;

PROC MIXED DATA=ncarbe;
  CLASS SEQ SUBJ PRD TRT ;
  MODEL LNAUCL = SEQ PRD TRT; 
  RANDOM SUBJ(SEQ) ;
  ESTIMATE 'T - R' TRT -1 1 /CL ALPHA=0.1;
  ODS OUTPUT ESTIMATES=ESTIM;
RUN;

DATA ESTIM;
  SET ESTIM;
  PE = EXP(Estimate);
  LL = EXP(Lower);
  UL = EXP(Upper);

PROC PRINT DATA=ESTIM; RUN;


PROC GLM DATA=ncarbe;
  CLASS SEQ SUBJ PRD TRT ;
  MODEL LNCMAX = SEQ SUBJ(SEQ) PRD TRT; 
  RANDOM SUBJ(SEQ)/TEST ; 
RUN;

PROC MIXED DATA=ncarbe;
  CLASS SEQ SUBJ PRD TRT ;
  MODEL LNCMAX = SEQ PRD TRT; 
  RANDOM SUBJ(SEQ) ;
  ESTIMATE 'T - R' TRT -1 1 /CL ALPHA=0.1;
  ODS OUTPUT ESTIMATES=ESTIM;
RUN;

DATA ESTIM;
  SET ESTIM;
  PE = EXP(Estimate);
  LL = EXP(Lower);
  UL = EXP(Upper);

PROC PRINT DATA=ESTIM; RUN;
